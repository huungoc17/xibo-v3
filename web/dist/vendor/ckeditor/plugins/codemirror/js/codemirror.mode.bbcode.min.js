CodeMirror.defineMode("bbcode",(function(e){var t,r,n;t="b i u s img quote code list table  tr td size color url",r="* :-) hr cut",e.hasOwnProperty("bbCodeTags")&&(t=e.bbCodeTags),e.hasOwnProperty("bbCodeUnaryTags")&&(r=e.bbCodeUnaryTags);var i=function(e,t){return n=t,e},o=function(e){return e.replace(/([\:\-\)\(\*\+\?\[\]])/g,"\\$1")},a=/[a-zA-Z0-9_]/,u=/['"]/,l=new RegExp("(?:"+o(t).split(" ").join("|")+")"),s=new RegExp("(?:"+o(r).split(" ").join("|")+")"),b={tokenizer:function(e,t){return e.eatSpace()?null:e.match("[",!0)?(t.tokenize=b.bbcode,i("tag","startTag")):(e.next(),null)},inAttribute:function(e){return function(t,r){for(var n=null,i=null;!t.eol();){if(i=t.peek(),t.next()==e&&"\\"!==n){r.tokenize=b.bbcode;break}n=i}return"string"}},bbcode:function(e,t){if(e.match("]",!0))return t.tokenize=b.tokenizer,i("tag",null);if(e.match("[",!0))return i("tag","startTag");var r=e.next();if(u.test(r))return t.tokenize=b.inAttribute(r),i("string","string");if(/\d/.test(r))return e.eatWhile(/\d/),i("number","number");if("whitespace"==t.last)return e.eatWhile(a),i("attribute","modifier");if("property"==t.last)return e.eatWhile(a),i("property",null);if(/\s/.test(r))return n="whitespace",null;var o="";"/"!=r&&(o+=r);for(var c=null;c=e.eat(a);)o+=c;return s.test(o)?i("atom","atom"):l.test(o)?i("keyword","keyword"):/\s/.test(r)?null:i("tag","tag")}};return{startState:function(){return{tokenize:b.tokenizer,mode:"bbcode",last:null}},token:function(e,t){var r=t.tokenize(e,t);return t.last=n,r},electricChars:""}})),CodeMirror.defineMIME("text/x-bbcode","bbcode");